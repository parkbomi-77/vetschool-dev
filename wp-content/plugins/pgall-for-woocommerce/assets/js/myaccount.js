jQuery(document).ready(function(a){"use strict";var b=function(a){return a.is(".processing")||a.parents(".processing").length},c=function(a){b(a)||a.addClass("processing").block({message:null,overlayCSS:{background:"#fff",opacity:.6}})},d=function(a){a.removeClass("processing").unblock()},e=a("textarea[name=reason]");a("select.pafw-ex-reason ").on("change",function(){var b=e.val();b.length>0&&(b+="\n"),e.val(b+a(this).val())}),a("input.reqeust-exchange-return").on("click",function(){var e=a("#pafw_ex_wrapper");b(e)||(c(e),a.ajax({url:_pafw_ex.ajaxurl,type:"POST",dataType:"json",data:"action="+_pafw_ex.action+"&_wpnonce="+_pafw_ex._wpnonce+"&"+a("form.pafw-ex-request").serialize(),success:function(a){console.log(a),a.success?(void 0!==a.data.message&&alert(a.data.message),void 0!==a.data.redirect_url?window.location.replace(a.data.redirect_url):d(e)):(void 0!==a.data.message?alert(a.data.message):alert("처리중 오류가 발생했습니다. 관리자에게 문의해주세요."),d(e))}}))}),a("input.button.pafw-show-change-next-payment-date").on("click",function(){a(this).closest("div").css("display","none"),a(".pafw-change-next-payment-date-wrapper").css("display","flex")}),a("input.pafw-change-next-payment-date").on("click",function(){var e=a("div.woocommerce"),f=a("input[name=pafw-next-payment-date]").val();if(""===f)return void alert("변경하실 결제일을 입력해주세요.");if(confirm("다음 결제일을 "+f+" 로 변경하시겠습니까?")){if(b(e))return;c(e),a.ajax({type:"POST",url:_pafw_subscription.ajax_url,data:{action:_pafw_subscription.slug+"-change_next_payment_date",subscription_id:_pafw_subscription.subscription_id,next_payment_date:f,_wpnonce:_pafw_subscription._wpnonce},success:function(a){a.success?window.location.reload():(alert(a.data),d(e))}})}}),a("table.subscription_details .cancel").on("click",function(b){b.preventDefault(),b.stopPropagation(),a.magnificPopup.open({items:{src:a(".pafw-cancel-reason-form"),type:"inline",midClick:!0},midClick:!0,closeBtnInside:!1,showCloseBtn:!1,fixedContentPos:!0})}),a(".pafw-cancel-reason-form .close").on("click",function(b){a.magnificPopup.close()}),a(".pafw-subscription-cancel-reason").on("change",function(b){var c=a("textarea[name=pafw-subscription-cancel-reason]");c.val(c.val()+a(this).val()+"\r\n")}),a("input.button.pafw-cancel-subscription").on("click",function(){var e=a("div.woocommerce"),f=a("textarea[name=pafw-subscription-cancel-reason]");if(_.isEmpty(f.val().trim()))return void alert("구독 취소 사유를 입력해주세요.");if(confirm("구독을 취소하시겠습니까?")){if(b(e))return;a.magnificPopup.close(),c(e),a.ajax({type:"POST",url:_pafw_subscription.ajax_url,data:{action:_pafw_subscription.slug+"-cancel_subscription",subscription_id:_pafw_subscription.subscription_id,cancel_reason:f.val(),_wpnonce:_pafw_subscription._wpnonce},success:function(a){a.success?window.location.reload():(alert(a.data),d(e))}})}});var f="";a("table.my_account_orders .cancel, table.pafw-payment-details .cancel").on("click",function(b){b.preventDefault(),b.stopPropagation(),f=a(this).attr("href"),a.magnificPopup.open({items:{src:a(".pafw-cancel-reason-form"),type:"inline",midClick:!0},midClick:!0,closeBtnInside:!1,showCloseBtn:!1,fixedContentPos:!0})}),a(".pafw-cancel-reason-form .close").on("click",function(b){a.magnificPopup.close()}),a(".pafw-order-cancel-reason").on("change",function(b){var c=a("textarea[name=pafw-order-cancel-reason]");c.val(c.val()+a(this).val()+"\r\n")}),a("input.button.pafw-cancel-order").on("click",function(){var e=a("div.woocommerce"),g=a("textarea[name=pafw-order-cancel-reason]");if(_.isEmpty(g.val().trim()))return void alert("주문 취소 사유를 입력해주세요.");if(confirm("주문을 취소하시겠습니까?")){if(b(e))return;a.magnificPopup.close(),c(e),a.ajax({type:"POST",url:_pafw_order.ajax_url,data:{action:_pafw_order.slug+"-survey_cancel_reason",redirect_url:f,cancel_reason:g.val(),_wpnonce:_pafw_order._wpnonce},success:function(a){a.success?window.location.href=f:(alert(a.data),d(e))}})}})});